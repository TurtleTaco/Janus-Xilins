#ifndef _JANUS_H_
#define _JANUS_H_

#include <stdio.h>
#include <stdlib.h>
#include "hls_math.h"
#include <stdint.h>
#include <string.h>
#include "hls_dsp.h"

// Number of particles
#define N 9

// Scale for conversion between FP and INT
const double scale_vel  = 1e-16;
const double inv_scale_vel = 1e16;
const double scale_pos  = 1e-16;
const double inv_scale_pos = 1e16;
const double scale_vel_pos = 1.;

// INT datatype used
#define REB_PARTICLE_INT_TYPE int64_t

REB_PARTICLE_INT_TYPE p_int[54] = {
		21709922250528, 57845061154043, -1290326677066,
		-3084904334499, 3164862379414, 72860648107,
		-1529074277548495, -4329649810759809, -217536815870956,
		12130892048755062, -4636664872138580, -1492230266727991,
		-7051385792282048, 1305062392874893, 423980407616931,
		-2107118903711193, -11628741220859936, -38067721592922,
		8303864923760965, 5551748865431480, -1556226179998,
		-5694403294004744, 8300359440285254, -250486216637,
		-16007632981663540, 4507843866326728, 485350310380760,
		-1874661855400607, -7140231189065021, -103688562255236,
		-45444724195553632, -29811209359531872, 1140115745580475,
		2354668506120313, -3459544002171689, -38305410200901,
		-2998316596246585, -100512228718170960, 1866942196718307,
		3063599906570191, -107135147677418, -120072161180579,
		178418531053445952, 88433796310403696, -1982994964737093,
		-1032131635550300, 1941992816066720, 20584917278455,
		286228992820092192, -87910334836014848, -4786090163574258,
		523633993793736, 1755278382196959, -48214129381180,
	};

double p[54] = {
        0.0021709922250528,  0.0057845061154043,  -0.0001290326677066,
        -0.0003084904334499,  0.0003164862379414, 0.0000072860648107,
        -0.1529074277548495,  -0.4329649810759809,  -0.0217536815870956,
        1.2130892048755062,  -0.4636664872138580, -0.1492230266727991,
        -0.7051385792282048,  0.1305062392874893,  0.0423980407616931,
        -0.2107118903711193,  -1.1628741220859935, -0.0038067721592922,
        0.8303864923760965,  0.5551748865431479,  -0.0001556226179998,
        -0.5694403294004744,  0.8300359440285254, -0.0000250486216637,
        -1.6007632981663540,  0.4507843866326728,  0.0485350310380760,
        -0.1874661855400607,  -0.7140231189065021, -0.0103688562255236,
        -4.5444724195553627,  -2.9811209359531872,  0.1140115745580475,
        0.2354668506120313,  -0.3459544002171689, -0.0038305410200901,
        -0.2998316596246585,  -10.0512228718170959,  0.1866942196718307,
        0.3063599906570191,  -0.0107135147677418, -0.0120072161180579,
        17.8418531053445939,  8.8433796310403689,  -0.1982994964737093,
        -0.1032131635550300,  0.1941992816066720, 0.0020584917278455,
        28.6228992820092181,  -8.7910334836014847,  -0.4786090163574258,
        0.0523633993793736,  0.1755278382196959, -0.0048214129381180,
    };

double p_mass[9] = {
        1.0000000000000000,
        0.0000001660114153,
        0.0000024478382878,
        0.0000030404326480,
        0.0000003227156038,
        0.0009547919152112,
        0.0002858856727222,
        0.0000436624373583,
        0.0000515138377263,
    };

//#pragma SDS data access_pattern(A:SEQUENTIAL, B:SEQUENTIAL, C:SEQUENTIAL)
void janus_run(REB_PARTICLE_INT_TYPE p_int_in[6*N], REB_PARTICLE_INT_TYPE p_int_out[6*N], double p_mass[N],int steps, double dt);
void astroSim(REB_PARTICLE_INT_TYPE result[54]);

#endif /* _JANUS_H_ */
